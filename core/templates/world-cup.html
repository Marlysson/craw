{% extends 'base.html' %}

{% block content%}

<div class="bigger-chart">
    <canvas id="bar-chart"></canvas>  
</div>

<div class="bigger-chart left">
        <canvas id="pie-chart"></canvas>
</div>


{% endblock %}

{% block script %}

<script type="text/javascript">

    var ctx = document.getElementById("bar-chart");
    var myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: {
            labels: {{ label_countries|safe }},
            datasets: [{
                label: 'Valores gastos estimados',
                data: {{ values_negotiated|safe }},
                backgroundColor: {{ background|safe }},
                borderColor : {{ border|safe }},
                borderWidth : 1.5,
            }]

        },
        options: {
            title : {
                    position:"top",
                    display:true,
                    text:"Gasto por estado na copa do mundo de 2014",
                    fontSize:25,
                    padding:20
            },

            tooltips: {
                callbacks : {

                    title : function(tooltipItem,chart){
                        
                        value = tooltipItem[0].yLabel;

                        if ( value < 999999.99){
                            return "Gasto em Milhares";
                        }else if ( value < 999999999.99){
                            return "Gasto em Milhões";  
                        }else{
                            return "Gasto em Bilhões";
                        }
                                                
                    },

                    label : function(tooltipItem,chart){
                        number = new Number(tooltipItem.xLabel);
                        return "R$ " + number.toLocaleString(undefined, {maximumFractionDigits:2})
                    }
                    
                }
            },

            scales: {
                xAxes: [{
                    ticks: {
                        callback: function(value, index, values) {
                            return value.toLocaleString();
                        }   
                    }
                }]
            }
        }
    });

</script>

<script type="text/javascript">
    
    var ctx = document.getElementById("pie-chart");
    var pie_chart = new Chart(ctx, {
        type: "doughnut",
        data: {
            datasets : [{ 
                data: {{ values_type_construction|safe }},
                backgroundColor: {{ color_pie|safe }}
            }],
            labels : {{ labels_type_construction|safe }} ,
        },
        options : {
            title : {
                position:"top",
                display:true,
                text:"Gastos por tipo de obras",
                fontSize:25,
                padding:40
            },
            legend : {
                display:true,
                position:"right"
            },
            tooltips: {
                callbacks : {

                    label : function(tooltip,data){
                        console.log(tooltip)
                        index = tooltip.index
                        value = data.datasets[0].data[index];

                        label = data.labels[index];

                        number = new Number(value);
                        number = number.toLocaleString(undefined, {maximumFractionDigits:2})

                        return label +": R$" +number;
                    }
                    
                }
            },

        }
    });

</script>
</script>
{% endblock %}